<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="mail.json"></script>
    <script src="https://kit.fontawesome.com/e5b4206cbc.js" crossorigin="anonymous"></script>
    </style>
</head>

<body>
    <div class="container">
        <!-- nav -->
        <div style="flex-grow: 1; background-color:#333333" class="nav">
            <img src="images/person.png" alt="" style="border-radius: 50%; margin-top: 30px;">
            <form class="block">
                <button class="compose-button mt30" type="button" id="form" onclick="showForm()">Compose</button>
            </form>
            <nav class="menu">
                <ul>
                    <li>
                        <div>
                            <i class="fas fa-envelope mr10 mb10"></i>
                            <a href="#" target="_blank">Inbox</a>
                        </div>
                    </li>
                    <li>
                        <div>
                            <i class="fas fa-bookmark mr10 mb10"></i>
                            <a href="#" target="">Improtant</a>
                        </div>
                    </li>
                    <li>
                        <div>
                            <i class="fas fa-paper-plane mr10 mb10"></i>
                            <a href="#" target="">Sent</a>
                        </div>
                    </li>
                    <li>
                        <div>
                            <i class="fas fa-exclamation-triangle mr10 mb10"></i>
                            <a href="#" target="">Drafts</a>
                        </div>
                    </li>
                    <li>
                        <div>
                            <i class="fas fa-folder mr10 mb10"></i>
                            <a href="#" target="">All Mail</a>
                        </div>
                    </li>
                    <li>
                        <div>
                            <i class="fas fa-exclamation-circle mr10 mb10"></i>
                            <a href="#" target="">Spam</a>
                        </div>
                    </li>
                    <li>
                        <div>
                            <i class="fas fa-trash-alt mr10"></i>
                            <a href="#" target="">Trash</a>
                        </div>
                    </li>
                </ul>
            </nav>
            <hr class="ml30 mr30">
            <h3 class="" style="color: #465162 ">Labels</h3>
            <nav class="menu">
                <ul>
                    <li>
                        <div>
                            <i class="fas fa-circle mr10 mb10" style="color: yellow;"></i>
                            <a href="#" target="_blank">Personal</a>
                        </div>
                    </li>
                    <li>
                        <div>
                            <i class=" fas fa-circle mr10" style="color: red;"></i>
                            <a href="#" target="">Bussiness</a>
                        </div>
                    </li>
                    <li>
                        <div>
                            <i class=" fas fa-circle mr10" style="color: blue;"></i>
                            <a href="#" target="">Work</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>

        <div style=" flex-grow: 7">
            <!-- filter -->
            <div style="display: flex; width: 100%; height: 100px; background-color: antiquewhite;">
                <div style="width: 70%; display: flex; flex-direction: column">
                    <div class="ml30" style="text-align: left">
                        <h1>Inbox</h1>
                    </div>
                    <div class="ml30">
                        <div style="text-align: left; display: flex; flex-direction: row"   >
                            <input type="checkbox" id="myCheck" onclick="Press()">
                            <div style="display: flex; flex-direction: row">
                                <div id="Trash" style="display: none;"> <i class="fas fa-trash-alt ml30"></i> </div>
                                <div id="Spam" style="display: none"> <i class="fas fa-exclamation-circle ml30"></i>
                                </div>
                            </div>
                            <script>
                                function Press() {
                                    let x = document.getElementById("Trash");
                                    let y = document.getElementById("Spam")
                                    if (x.style.display === "block" && y.style.display === "block") {
                                        x.style.display = "none";
                                        y.style.display = "none";
                                    } else {
                                        x.style.display = "block";
                                        y.style.display = "block";
                                    }
                                }
                            </script>
                        </div>
                    </div>
                </div>
                <div class="search-bar">
                    <form action="">
                        <input type="text" placeholder="Search..." name="search">
                        <button type="submit"><i class="fa fa-search"></i></button>
                    </form>
                </div>
            </div>
            <!-- main -->
            <div class="main" id="main">
                <div style="margin: 20px 0;">
                    <div class="w10"><img src="images/avr_1.png" alt="" style="width: 48px; border-radius: 50%;"></div>
                    <div class="flex w75">
                        <div>
                            <div style="height: 25px;">
                                <h4 class="mt0">Welcome to Vietnam</h4>
                            </div>
                            <div>
                                <form class="ml10 fl">
                                    <button style="background-color: green; border: none; color: white;" type="button"
                                        onclick="">Client</button>
                                    <button style="background-color: blue; border: none; color: white;" type="button"
                                        onclick="">Work</button>
                                </form>
                            </div>
                        </div>
                        <div>
                            <p class="mt0" style="text-align: left;">
                                Welcome To your dashboard. here you can manage and coordinate any activities</p>
                        </div>
                    </div>
                    <div class="w10" style="padding: 15px 0px;">2 hours</div>
                    <div class="w5">
                        <label class="container1">
                            <input type="checkbox">
                        </label>
                    </div>
                </div>
                <div style="margin: 20px 0;">
                    <div class="w10"><img src="images/avr_3.png" alt="" style="width: 48px; border-radius: 50%;"></div>
                    <div class="flex w75">
                        <div>
                            <div style="height: 25px;">
                                <h4 class="mt0">Welcome to Vietnam</h4>
                            </div>
                            <div>
                                <form class="ml10 fl">
                                    <button style="background-color: green; border: none; color: white;" type="button"
                                        onclick="">Client</button>
                                    <button style="background-color: blue; border: none; color: white;" type="button"
                                        onclick="">Work</button>
                                </form>
                            </div>
                        </div>
                        <div>
                            <p class="mt0" style="text-align: left;">
                                Welcome To your dashboard. here you can manage and coordinate any activities</p>
                        </div>
                    </div>
                    <div class="w10" style="padding: 15px 0px;">2 hours</div>
                    <div class="w5">
                        <label class="container1">
                            <input type="checkbox">
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- mail form -->
        <div id='mailForm' class="mail-form">
            <div class="blocker" onclick="hidePopup()"></div>
            <div id="mfWrapper">
                <form name="mail">
                    <!-- head form -->
                    <div class="head-form">
                        <div style="flex-grow: 7" class="head-form-content">
                            <p>Compose</p>
                        </div>
                        <div class="head-form-close">
                            <div style="margin: 16px;" id="closeForm">
                                <span><i class="fas fa-times"></i></span>
                            </div>
                        </div>
                    </div>
                    <!-- form content -->
                    <div class="form-group">
                        <label for="">To</label>
                        <input type="text" name="txtTo">
                    </div>
                    <div class="form-group">
                        <label for="">Title</label>
                        <input type="text" name="txtTitle">
                    </div>
                    <div class='form-group'>
                        <label for="">Label</label>
                        <select id="lstLabel" name="ls">
                            <option value="0">Select label:</option>
                            <option value="Personal">Personal</option>
                            <option value="Work" style='background-color:white'>Work</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="">Message</label>
                        <input class="" style="height:150px" placeholder="What's on your mind?" name="txtMessage">
                    </div>
                    <!-- attach file + submit -->
                    <div class="form-submit">
                        <div class="attachment">
                            <button type="button" class="attachment-btn">
                                <span><i class="fas fa-plus"></i></span>
                                <span>attchment</span>
                                <input type="file" class="file-input" name="files[]" multiple=""
                                    style="opacity: 0;position: absolute;z-index: -1;">
                            </button>
                        </div>
                        <div class="submit">
                            <button type="button" class="submit-btn" id="btnSend">send</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <script>
            "use strict";

            // pop-up
            const showForm = () => {
                document.getElementById('mailForm').style.display = 'block'
            }

            document.getElementById("btnSend").onclick = () => {
                // renderItem(mailData())
                // mailData()
                document.getElementById('mailForm').style.display = 'none'
            }

            document.getElementById("closeForm").onclick = () => {
                document.getElementById('mailForm').style.display = 'none'
            }

            function hidePopup() {
                document.getElementById('mailForm').style.display = 'none'
            }

            //mail form 
            let userMails = []
            var userHtml = []

            //create mail
            //local storage
            function createMail(name, message, label = '') {
                // this.name = name;
                // this.message = message;
                // this.label = label
                if (name != '' && message != '') {
                    const userMail = {
                        id: Date.now(),
                        v1: 'inbox',
                        name: name,
                        message: message,
                        label: label,
                        labelColor: labelColor(label),
                        avatar: "images/avr_1.png",
                        important: '',
                    }
                    userMails.push(userMail)
                    console.log(userMails)
                    addLocalStorage(userMails)
                };

            }
            // oop
            // function createMail(name, message, label) {
            //     this.name = name;
            //     this.message = message;
            //     this.label = label
            // }

            // mail form
            const itemList = (data, type) => {
                return `
                <div style="margin: 20px 0;">
                <div class="w10"><img src="${data.avatar}" alt="" style="width: 48px; border-radius: 50%;"></div>
                <div class="flex w75">
                    <div>
                        <div style="height: 25px;">
                            <h4 class="mt0">${data.name}</h4>
                        </div>
                        <div>
                            <form class="ml10 fl">
                                <button style="background-color: ${data.labelColor}; border: none; color: white;" type="button"
                                    onclick="">${data.label}</button>
                            </form>
                        </div>
                    </div>
                    <div>
                        <p class="mt0" style="text-align: left;">
                            ${subString(data.message.split(' '), 0, 10)}</p>
                    </div>
                </div>
                <div class="w10" style="padding: 15px 0px;">2 hours</div>
                <div class="w5">
                    <label class="container1">
                        <input type="checkbox">
                    </label>
                </div>
            </div>`
            }

            const renderItem = (res) => {
                let html = res.map(data => {
                    let dataUser = itemList(data)
                    // console.log(dataUser)
                    userHtml.push(dataUser)
                    return dataUser
                }).join('')

                document
                    .querySelector('#main')
                    .insertAdjacentHTML('afterbegin', html)

            }

            const subString = (array, first, last) => {
                return array.slice(first, last).join(' ')
            }

            renderItem(userMails)

            function labelColor(label) {
                if (label != '') {
                    return 'blue'
                }
            }

            const mailData = () => {
                let txtTo = document.querySelector('input[name="txtTo"]')
                let label = document.getElementById('lstLabel')
                let txtTitle = document.querySelector('input[name="txtTitle"]')
                let txtMessage = document.querySelector('input[name="txtMessage"]')
                let mail = createMail(txtTo.value, `${txtTitle.value}. ${txtMessage.value}`, label.options[label
                    .selectedIndex].value);
                txtTo.value = ''
                label.value = ''
                txtTitle.value = ''
                txtMessage.value = ''
                return [mail]
            }

            // local storage
            // add data to local storage
            function addLocalStorage(data) {
                localStorage.setItem('mail', JSON.stringify(data))
            }
            // get data from local storage
            function getFromLocalStorage() {
                const reference = localStorage.getItem('mail');
                if (reference) {
                    userMails = JSON.parse(reference);
                    renderItem(userMails);
                }
            }
            getFromLocalStorage()
        </script>
</body>

</html>